<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–∞—Ç–∞–ª–æ–≥ Paida All</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body {
      padding-top: 60px;
      background: #f8f9fa;
    }
    .header {
      position: fixed;
      top: 0;
      width: 100%;
      background-color: white;
      z-index: 1000;
      border-bottom: 1px solid #ddd;
      padding: 10px 15px;
    }
    .product-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      background: white;
      transition: transform 0.2s;
    }
    .product-card:hover {
      transform: scale(1.02);
    }
    .product-img {
      width: 100%;
      max-height: 150px;
      object-fit: contain;
    }
    .whatsapp-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #25D366;
      color: white;
      border: none;
      padding: 12px 16px;
      border-radius: 50%;
      font-size: 24px;
      z-index: 1000;
    }
    .admin-tools {
      display: none;
    }
    .admin-visible {
      display: block;
    }
    @media (max-width: 768px) {
      .product-card {
        margin-bottom: 15px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h5 class="mb-0">Paida All | –ö–∞—Ä–∞–≥–∞–Ω–¥–∞, –ê–ª–∏—Ö–∞–Ω–æ–≤–∞ 37 (—Ü–æ–∫–æ–ª—å), 13:00‚Äì20:00</h5>
    <p class="mb-1">–ó–∞–∫–∞–∑—ã –ø–æ—Å–ª–µ 13:00 –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å</p>
  </div>

  <div class="container mt-4">
    <div id="category-filter" class="mb-3"></div>
    <div class="row" id="product-list"></div>

    <div class="admin-tools" id="admin-panel">
      <hr>
      <h5>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)</h5>
      <form id="add-product-form" class="row g-2">
        <div class="col-md-3"><input type="text" id="name" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ"></div>
        <div class="col-md-2"><input type="text" id="price" class="form-control" placeholder="–¶–µ–Ω–∞"></div>
        <div class="col-md-3"><input type="text" id="img" class="form-control" placeholder="URL –∫–∞—Ä—Ç–∏–Ω–∫–∏"></div>
        <div class="col-md-2"><input type="text" id="category" class="form-control" placeholder="–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å"></div>
        <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">–î–æ–±–∞–≤–∏—Ç—å</button></div>
      </form>
      <button class="btn btn-secondary mt-2" onclick="toggleArchive()">–ü–æ–∫–∞–∑–∞—Ç—å/–°–∫—Ä—ã—Ç—å –∞—Ä—Ö–∏–≤</button>
    </div>
  </div>

  <a href="https://wa.me/77780855478" class="whatsapp-button" title="–ù–∞–ø–∏—Å–∞—Ç—å –≤ WhatsApp">
    üí¨
  </a>

  <script>
    const supabaseUrl = "https://qmnnbotyzwftlhwakbnz.supabase.co"
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFtbm5ib3R5endmdGxod2FrYm56Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwOTE3MzYsImV4cCI6MjA2NzY2NzczNn0.QaHkN4M4_Deh4HN4CZ-spv8QKbGKzhrfGwMvr6Pbyv4"
    const client = supabase.createClient(supabaseUrl, supabaseKey);
    let isAdmin = false;

    document.addEventListener("DOMContentLoaded", async () => {
      if (prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:") === "erema") {
        isAdmin = true;
        document.getElementById("admin-panel").classList.add("admin-visible");
      }
      await loadProducts();
    });

    async function loadProducts() {
      const { data, error } = await client.from("products").select("*");
      if (error) return alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤");
      const list = document.getElementById("product-list");
      list.innerHTML = "";
      data.forEach(prod => {
        if (!prod.archived || isAdmin) {
          const col = document.createElement("div");
          col.className = "col-6 col-md-4 col-lg-3 mb-3";
          col.innerHTML = `
            <div class="product-card">
              <img src="${prod.img}" alt="${prod.name}" class="product-img">
              <h6>${prod.name}</h6>
              <p><strong>${prod.price} ‚Ç∏</strong></p>
              <small>${prod.category}</small>
            </div>`;
          list.appendChild(col);
        }
      });
    }

    document.getElementById("add-product-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value;
      const price = document.getElementById("price").value;
      const img = document.getElementById("img").value;
      const category = document.getElementById("category").value;
      await client.from("products").insert([{ name, price, img, category, archived: false }]);
      await loadProducts();
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</body>
</html>
